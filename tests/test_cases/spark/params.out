/* Success! If you're still running into issues, check out https://dune.com/docs/query/syntax-differences/ or reach out in the #dune-sql Discord channel. */

SELECT
  time
FROM 
CROSS JOIN UNNEST(SEQUENCE(
  CAST(SUBSTR(CAST(CAST('{{1 - Start Date}}' AS TIMESTAMP) AS VARCHAR), 1, 10) AS DATE),
  LEAST(
    CURRENT_TIMESTAMP,
    CAST(SUBSTR(CAST(CAST('{{2 - End Date}}' AS TIMESTAMP) AS VARCHAR), 1, 10) AS DATE)
  ),
  INTERVAL '1' {{3 - Time Granularity}}
) /* WARNING: Check out the docs for example of time series generation: https://dune.com/docs/query/syntax-differences/ */) AS array_column(time)